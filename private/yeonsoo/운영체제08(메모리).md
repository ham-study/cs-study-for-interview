## 메모리 관리 필요성

과거 일괄처리 시스템에서는 한번에 한 가지 작업만 처리했기 때문에 메모리 관리가 어렵지 않았다.

하지만 시분할 시스템에서는 운영체제를 포함한 여러 응용프로그램들이 메모리에 올라와 실행되기 때문에 메모리가 복잡해진다. 이에 따라 메모리 관리 시스템을 통해 프로그램마다 충분한 작업공간을 확보해야 한다

## 32bit CPU VS 64bit CPU

- CPU 내부 부품은 해당되는 비트 수 기준으로 제작된다
- 레지스터,산술논리 연산 장치, 데이터를 전송하는 각종 버스의 크기 의 크기는 해당되는 비트수이다.
- 메모리 주소 레지스터(MAR)가 32비트로 만들어지면 주소가 2의 32승개만큼 생긴다. 따라서 메모리는 2의 32승인 4GB까지 사용할 수 있다.
- 물리 주소공간: 하드웨어 입장에서 바라본 주소공간, 컴퓨터마다 크기가 다르다
- 논리 주소공간: 사용자 입장에서 바라본 주소 공간

## 고정분할 방식, 가변 분할 방식

메모리를 어떤 크기로 나눌 것인가는 메모리 배치 정책에 해당된다. 메모리에 여러개의 프로세스를 배치하는 방법은 가변분할과 고정 분할 방식으로 나뉜다

## 고정 분할 방식(페이징)

프로세스의 크기에 상관없이 메모리가 같은 크기로 나뉘며, 큰 프로세스가 메모리에 올라오면 여러 조각으로 나뉘어 배치된다. 한 프로세스가 분산되어 배치되기 때문에 비연속 메모리 할당이라고 한다.

**장점**

- 프로세스를 일정한 크기로 나누어 관리하기 때문에 가변 분할 방식 처럼 조각 모음을 할 필요가 없어 메모리 관리가 수월하다.→ 현대의 메모리 관리 시스템은 고정 분할 방식을 기본으로 사용하고 있다.
- 가변 분할 방식의 메모리 통합 같은 부가적인 작업을 할 필요가 없다.

**단점**

- 쓸모없는 공간으로 인해 메모리 낭비가 발생할 수 있다.→ 일정하게 나누어진 공간보다 작은 프로세스가 올라올 경우 내부 단편화가 생긴다
- 프로세스가 조각으로 나뉘어 저장된다.

### 내부 단편화

일정한 크기로 메모리 조각 안에서 프로세스를 배치하고 공간이 남은 현상

**해결**

동일하게 분할되는 공간의 크기를 조절해서 내부 단편화를 최소화 시킨다.

## 가변 분할 방식

프로세스의 크기에 맞게 메모리가 분할되어 메모리의 영역이 각각 다르다.

한 프로세스가 연속된 공간에 배치되기 때문에 연속 메모리 할당이라고 한다.

**외부** **단편화**

물리 메모리에서 프로세스가 종료되어 빈 영역이 존재함에도 불구하고 서로 떨어져 있으면 프로세스를 배정하지 못해 작은 조각들이 발생하는 현상

**보완 방법**

- 배치방식: 작은 조각이 발생하지 않도록 프로세스를 배치하는 방식(선처리)
- 조각 모음: 조각이 발생했을 때 작은 조각들을 모아서 하나의 덩어리로 만드는 작업(후처리)

### 메모리 배치 방식

**최초 배치**

- 단편화를 고려하지 않는것
- 프로세스를 메모리의 빈공간에 배치할때 가능한 공간을 순서대로 찾다가 첫 번째로 발견한 공간에 프로세스를 배치하는 방법

**최적 배치**

- 메모리의 빈공간을 모두 확인한 후 적당한 크기 가운데 가장 작은 공간에 프로세스를 배치한다
    - 단점: 딱 맞는 공간이 없을때 작은 조각을 만들 가능성이 있다.

**최악 배치**

- 최적 배치과 정반대로 빈공간을 모두 확인한 수 가장 큰 공간에 프로세스를 배치한다.
- 남은 공간이 크기 때문에 쓸모가 있어 효율적으로 사용할 수 있다.
- 빈공간의 크기가 클 때는 효과적이지만 빈공간의 크기가 점점 줄어들면 최적 배치처럼 작은 조각을 만들어 낸다.

### 조각 모음

단편화가 발생하면 이미 배치된 프로세스를 옆으로 옮겨 빈공간들을 하나의 큰 덩어리로 만드는 작업이다.

가변 분할 방식의 목적은 프로세스를 한덩어리로 취급하여 메모리 관리의 효율성을 높이는 것인데 메모리 배치 방식으로는 근본적으로 문제를 해결하지 못한다. 따라서 조각 모음을 통해 이를 보완한다.

**순서**

1. 조각 모음을 하기 위해 이동할 프로세스의 동작을 멈춘다.
2. 프로세스를 적당한 위치로 이동한다. (프로세스의 상대 주소값을 바꾸는 방식으로)
3. 작업을 모두 마친 후 프로세스를 다시 시작한다.

**장점**

- 프로세스를 한 덩어리로 처리하여 하나의 프로세스를 연속된 공간에 배치한다.

**단점**

- 메모리관리 측면에서 매우 불편하다→ 메모리 배치,조각모음 등 부가적인 작업이 필요하다.

→현대 운영체제에서는 기본적으로 고정 분할 방식을 사용하면서 일부분은 가변 분할 방식을 혼합 하고 있다.