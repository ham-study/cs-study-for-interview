# Load Balancer

<br>

## 로드밸런서

- 다수의 트래픽이 발생할 때, 부하를 분산하여 여러대의 서버가 처리하도록 하는 기술
- 트래픽이 적다면 한대의 서버로 부하를 감당할 수 있지만, 트래픽이 많아진다면 ?
    - **Scale Up**
        - 서버 자체의 성능을 향상시키는 것
        - CPU나 메모리를 늘리는 것
    - **Scale Out**
        - 동일한 서버를 여러개 더 만드는 것
        - 트래픽 분산을 위해 로드밸런싱이 필요함

<br>

## 로드밸런싱 알고리즘

### 라운드로빈 (Round Robin)

- 서버에 들어온 요청을 순서대로 돌아가며 공평하게 분배
- 여러대의 서버가 동일한 스펙 + 연결이 오래 지속되지 않는 경우 적합

### 가중 라운드로빈 (Weighted Round Robin)

- 각각 서버가 가중치를 가지며 가중치가 높은 서버에 우선 분배
- 서버의 스펙이 서로 다른 경우 적합

###  IP 해시 방식 (IP Hash)

- 사용자 IP를 해싱하여 특정 서버로 매핑하여 분배하는 방식
- 사용자는 항상 동일한 서버로 연결됨

### 최소 연결 방식 (Least Connection)

- 요청 시점에 가장 놀고있는 서버로 분배
- 요청 처리 시간이 모두 상이하거나 트래픽이 일정하지 않은 경우에 적합

### 최소 리스폰타임 (Least Response Time)

- 서버의 현재 연결 상태 + 응답시간을 모두 고려하여 분배
- 가장 적은 연결상태와 가장 짧은 응답시간을 보이는 서버가 우선순위

<br>

## 계층별 로드밸런싱

### L2

- 데이터링크 계층
- Mac 주소로 로드밸런싱

### L3 

- 네트워크 계층
- IP 주소로 로드밸런싱

### L4

- 전송 계층
- 포트번호로 로드밸런싱 
- NLB(Network LoadBalancer)

### L7

- 응용 계층
- 패킷 내용 확인후 그 내용에 따라 로드밸런싱
    - URL이나 HTTP 헤더 쿠키값에 따라 부하 분산 가능
- ALB(Application LoadBalancer)

<br>