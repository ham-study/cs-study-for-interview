# 운영체제 소개

## 운영체제 필요성

- 효율성
  : 메모리나 CPU같은 컴퓨터 자원을 효율적으로 이용하기 위해서

## 운영체제 정의

: 사용자가 편리하게 컴퓨터를 이용할 수 있도록 컴퓨터 자원을 관리하는 소프트웨어

## 운영체제 역할

1. 자원 관리
2. 자원 보호
3. 하드웨어의 인터페이스 제공
4. 사용자 인터페이스 제공

# 운영체제 구조

- 단일형 : 초기의 운영체제 구조, 작고 간단하며 시스템 기능이 제한되어있음.
    - 새로운 기능을 추가하거나 유지보수하는데 힘듦.
- 계층형 : 다수의 계층으로 구성
    - 사용자 프로세서의 요청을 수행하는데 많은 계층을 거쳐야해서 성능이 저하됨.
- 마이크로형

## 커널

: 운영체제의 핵심 부분, 컴퓨터의 자원의 접근을 제어하는 것

## 시스템 호출

: 응용 프로그램의 요청에 따라 커널에 접근하기 위한 인터페이스

- 사용자 모드 <> 운영체제 모드 를 바뀌게 하는 것.
- 호출 유형
    - 프로세스 제어(process control)
    - 파일 조작(file manipulation)
    - 장치 관리(device management)
    - 정보 유지(information maintenance)
    - 통신(communication)

# 프로세스

## 프로세스 개념

: 실행중인 프로그램, 메모리 공간에 올라와 CPU의 대기를 받는 상태, 최소 하나 이상의 쓰레드를 들고 있음

## 프로세스 상태

![img](https://t1.daumcdn.net/cfile/tistory/99E85E3A5C460F1906)

## 프로세스 제어 블록

: 특정한 프로세스를 관리할 필요가 있는 정보를 포함하는 운영 체제 커널의 자료 구조

- 포함된 내용

1) 프로세스 식별자(Process ID)

2) 프로세스 상태(Process State) : 생성(create), 준비(ready), 실행 (running), 대기(waiting), 완료(terminated) 상태가
   있습니다.

3) 프로그램 계수기(Program Counter) : 프로그램 계수기는 이 프로세스가 다음에 실행할 명령어의 주소를 가리킵니다.

4) CPU 레지스터 및 일반 레지스터

5) CPU 스케줄링 정보 : 우선 순위, 최종 실행시각, CPU 점유시간 등

6) 메모리 관리 정보 : 해당 프로세스의 주소 공간 등

7) 프로세스 계정 정보 : 페이지 테이블, 스케줄링 큐 포인터, 소유자, 부모 등

8) 입출력 상태 정보 : 프로세스에 할당된 입출력장치 목록, 열린 파일 목록 등

9) 포인터 : 부모프로세스에 대한 포인터, 자식 프로세스에 대한 포인터, 프로세스가 위치한 메모리 주소에 대한 포인터, 할당된 자원에 대한 포인터 정보 등.

## 프로세스 문맥 교환

새로운 프로세스를 실행하기 위해 인터럽트가 발생할 때, 진행 중인 프로그램의 레지스터 문맥을 PCB에 저장하고, 앞으로 실행될 프로세스의 상태 정보를 설정한 다음에 CPU를
할당하여 실행되도록 하는 작업을 문맥 교환

# 스레드

## 스레드 개념

: 어떠한 프로그램 내에서, 특히 프로세스 내에서 실행되는 흐름의 단위를 말한다.

## 멀티스레드의 구조

![img](https://wayhome25.github.io/assets/post-img/cs/thread.png)

## 멀티스레드의 장단점

장점

- 프로그램의 일부분(스레드)이 중단되거나 긴 작업을 수행하더라도 프로그램의 수행이 계속 되어 사용자에 대한 응답성이 증가한다.

단점

- Critical Section 문제가 발생할 수 있다. (병목현상, 데드락)

## 멀티 프로세스 VS 멀티 스레드

- 멀티 스레드가 속도면에서 유리
    - 멀티 프로세스 : Context Switching 과정에서 캐시 메모리 초기화 등 무거운 작업이 진행되고 시간이 소모되는 등 오버헤드가 발생한다.
    - 멀티 스레드 : 스레드 사이 작업량이 작아 Context Switching이 빠르다. (캐시 메모리를 비울 필요가 없다.)
- 멀티 프로세스 장점
    - 독립된 구조로 안전성이 높은 장점이 있다.
    - 프로세스 중 하나에 문제가 생겨도 다른 프로세스에 영향을 주지 않아, 작업속도가 느려지는 손해정도는 생기지만 정지되거나 하는 문제는 발생하지 않는다.

# 예상 질문

- 교착 상태의 조건이 뭔가요?
    1. 상호 배제(Mutual Exclusion) : 한 자원에 대한 여러 프로세스의 동시 접근은 불가능하다. 즉, 하나의 자원을 특정 시기에 하나의 프로세스나 스레드만
       소유할 수 있는 형태.

    2. 점유와 대기(Hold and Wait) : 하나의 자원을 소유하고 다른 프로세스 혹은 스레드의 자원을 요청하는 상태이다.

    3. 비선점(Non preemptive) : 하나의 프로세스나 스레드에게 주어진 자원은 해당 프로세스나 스레드가 스스로 놓기 전에는 놓게 만들 수 없는 상태. 즉, 다른
       프로세스에서 자원을 사용하는 동안 자원을 강제로 가져올 수 없다.

    4. 환형 대기(Circle wait) : 각 프로세스가 다음 프로세스가 요구하는 자원을 가지고 있는 것을 말한다. 두 개의 프로세스나 스레드의 경우, A -> B, B
       -> C, C -> A에게 서로 자원을 요청하고 기다리는 상황

- 뮤 텍스란 무엇입니까?
    - 프로세스 혹은 스레드 간의 통신 시에 shared memory 등을 쓰는 경우 하나의 자원에 두 개 이상의 프로세스 혹은 스레드가 접근하는 경우에 문제가 발생한다. 이를
      제어하기 위해 스레드는 뮤 텍스를 사용하고, 프로세스에서는 세마포어를 사용한다.
    - 뮤 텍스 : 상호 배제라고도 하며, Critical Section을 가진 스레드의 Running Time이 서로 겹치지 않도록 각각 단독으로 실행하게 하는 기술이다. 뮤
      텍스는 상태가 0, 1 두 개뿐인 이진 세마포어. synchronized 또는 lock을 통해 해결한다.

- 세마포어란 무엇입니까?
    - 세마포어는 사용 중인 리소스를 잠그는 데 사용되는 보호된 변수 또는 추상 데이터 유형이다. 공유된 자원의 데이터를 여러 '프로세스'에서 접근하는 것을 막는다. 세마포어의
      값은 공통 자원의 상태를 나타냅니다. 리소스 상태를 나타내는 간단한 카운터이다. 공유 리소스에 접근할 수 있는 프로세스의 최대 허용치만큼 동시에 사용자가 접근하여 사용할
      수 있다.

- 뮤 텍스와 세마포어의 차이?
    - 가장 큰 차이는 동기화 대상의 개수이다. 뮤 텍스는 동기화 대상이 하나뿐이고, 세마포어는 동기화 대상이 하나 이상일 때.

- 운영 체제에서 기아(Starvation) 란 무엇입니까?
    - 특정 프로세스의 우선순위가 낮아서 원하는 자원을 계속 할당받지 못하는 상태이다. 기아상태는 자원 관리 문제이다. 이 문제에서 대기 중인 프로세스는 리소스가 다른
      프로세스에 할당되어 있기 때문에 오랫동안 필요한 리소스를 얻지 못한다.

- 운영 체제에서 에이징(Aging)은 무엇입니까?
    - 에이징은 자원 스케줄링 시스템에서 기아를 방지하기 위해 사용되는 기술이다. 특정 프로세스의 우선순위가 낮아 무한정 기다리게 되는 경우, 한번 양보하거나 기다린 시간에
      비례하여 일정 시간이 지나면 우선순위를 한 단계씩 높여 가까운 시간 안에 자원을 할당받도록 하는 기법을 말한다.

- 운영 체제에서 페이징(Paging)은 무엇입니까?
    - 세그먼테이션과 가상 메모리를 고정된 크기로 나누어 메모리(가상 메모리)를 관리하는 기법을 말한다. 자세하게 말하자면 커다란 크기의 작업을 일정한 크기로 나누어 잘게
      쪼개어 처리하는 것이다. 따라서 불연속적인 메모리 요청 등에 유연하게 처리할 수 있다. 세그먼테이션은 논리적 블록을 필요에 따라 다른 크기로 할당한 것이라면, 페이징은
      고정된 크기로 나누는 것이다. 외부 단편화는 해결하지만, 내부 단편화가 발생할 수 있다.

- 페이징의 장점과 단점은?
    - 장점: 메모리를 페이지 단위로 가져와서, 프로세스의 효율적인 운영이 가능하다. 단점: 페이지 크기별, 단위별로 페이지 폴트 현상이 발생할 수 있다.

- 세그먼테이션(Segmentation) 이란?
    - 메모리를 서로 크기가 다른 논리적인 블록 단위인 세그먼트(segment)로 분할하고 메모리를 할당하여 물리 주소를 논리 주소로 변환하는 것을 말한다. 미리 분할하는 것이
      아니라 메모리를 사용할 시점에 할당된다. 내부 단편화는 없지만 외부 단편화가 발생할 수 있다.

4/4(월) 피드백

- 쓰레드 메모리 구조는 꼭 알아야한다.

프로세스 구조는 크게 Code영역, Data영역, Stack영역, Heap영역, 이 있습니다. Code영역은 프로그램의 코드가 기계어 형태로 저장된 공간으로 Read-only로
되어있습니다. Data영역은 전역 변수와 static 변수들이 저장된 공간입니다. Stack영역은 함수 호출과 관련된 지역변수와 매개 변수가 저장된 공간입니다. 함수가 끝나면
반환됩니다. Heap영역은 동적 메모리 영역으로 메모리 주소값에 의해서만 참조되고 사용되는 영역입니다. 이 외에도 쓰레드 레지스터가 존재하는데 쓰레드 레지스터는 쓰레드의 정보를
저장하고 있습니다.

# CPU 스케줄링

## 장기 스케줄링

- 장기 스케쥴러(잡 스케쥴러)가 READY QUEUE에 프로세스를 적재해주는 것

## 중기 스케줄링

: 어떤 프로세스들이 CPU를 할당받을 것인지 결정

## 단기 스케줄링

- 숏텀 스케쥴러(CPU 스케쥴러)가 준비된 프로세스 중 하나를 골라 CPU에게 할당하는 것
- 디스패처에 의해 동작됨

# 스케줄링 알고리즘

## FCFS

## SJF

## Round Robin

## SRT

## Priority scheduling

## Multilevel Queue

## Multilevel Feedback Queue

# 인터럽트

## 인터럽트 개념

## 동기적 인터럽트, 비동기적 인터럽트

## 인터럽트 처리 과정

## 인터럽트와 이중 모드

# 예상질문

- 프로세스 스케쥴링 중 장기, 중기, 단기 스케쥴링에 대해서 말해주세요.
    - 프로세스 스케쥴링에는 장기 스케쥴링, 중기 스케쥴링, 단기 스케쥴링이 있습니다.
    - 장기 스케쥴링은 새로운 프로세스가 생성되었을 때, 장기 스케쥴러(즉, 잡 스케쥴러)가 프로세스를 선별하여 레디큐에 올리는 것을 말합니다.
    - 중기 스케쥴링은 중기 스케쥴러를 통해 어떠한 인터럽트나 타임아웃의 경우 중기 스케쥴러가 작동하여 CPU에 올릴 프로세스를 변경해주는 것을 말합니다.
    - 단기 스케쥴링은 단기 스케쥴러를 통해 준비 상태인 프로세스 중 다음으로 어떤 프로세스를 실행할지 결정해주는 것을 의미합니다.

- 선점 스케쥴링에 대해서 말해주세요.
- 선점 스케쥴링 기법에는 FIFO, SJF,
    - FIFO
        - 들어온 순서대로 처리하는 스케쥴링 기법입니다.
        - 장점으로는 먼저 도착한 프로세스는 먼저 처리하기 때문에 공정성을 가집니다. 그리고, 선입선출 큐로 쉽게 관리가 가능합니다.
        - 단점으로는 호송효과가 발생합니다. 즉, 하나의 큰 프로세스를 먼저 처리하게되면 작은 프로세스들은 기다리게 됩니다.

    - SJF
        - SRT(Shortest Remaining Time)
            - 프로세스들 중 작업 시간이 가장 작은 순서대로 처리하는 스케쥴링기법입니다. 크게 SJF, HRN이 있습니다.
            - 장점으로는 효율적으로 일을 처리할 수 있습니다. 대기 시간이 짧아집니다.
            - 단점으로는 기아현상이 발생할 수 있고, 선점에 따른 부하가 발생할 수 있습니다.

- 비선점 스케쥴링에 대해서 말해주세요.
- 비선점 스케쥴링 기법에는 Round Robin, Priority Scheculing기법이 있습니다.
    - Round Robin
        - 시간 할당량을 정해두고 해당 시간이 끝나면 인터럽트가 발생하며 강제로 CPU를 빼앗는 기법입니다.
    - Priority scheduling
        - 각 프로세스들에게 우선순위를 부여한 뒤 순위가 높은 순서부터 차례로 처리하는 스케쥴링 기법입니다.
        - 효율성이 좋다는 장점이 있지만 계속 높은 우선순위 프로세스가 들어올 경우 기아문제가 발생할 수 있습니다.
        - 따라서 에이징 기법을 함께 사용해주면 좋습니다.
    - Multilevel Queue
        - 작업들을 여러 종류로 그룹을 나누고 여러개의 큐를 이용하는 기법입니다.
        - 각 큐마다 독자적인 스케쥴링에 따라 CPU를 할당받는 방법입니다.
        - 일괄 처리 작업이 실행 중일지라도 상위 단계 큐에 작업이 들어오면 선점당합니다.
    - Multilevel Feedback Queue
        - 프로세스의 특성에 따라서 서로 다른 cpu 타임 슬라이스를 부여하는 기법입니다.
        - 시간 할당량을 채우고나면 다음 큐로 배치되고, 가장 낮은 순위 큐에 도달하면 순환할당 방식으로 스케쥴링합니다.

- 인터럽트가 뭔가요?
    - CPU가 프로세스를 처리하는 중 입출력이나 타임아웃과 같은 예외상황이 발생했을 때 처리가 필요한 경우 마이크로 프로세서에게 알려 처리할 수 있도록 하는 것입니다.
    - 인터럽트에는 크게 두가지로 나뉩니다. 동기적 인터럽트와 비동기적 인터럽트가 있습니다.
    - 비동기적 인터럽트는 하드웨어 인터럽트라고도 합니다.I/O와 관련된 외부의 돌발적인 상황이 발생하였을 때 CPU는 실행중인 작업들을 일시 중지하고 정해진 인터럽트 작업을
      수행합니다.
    - 동기적 인터럽트는 소프트웨어 인터럽트라고도 합니다.CPU 내부에서 발생하는 인터럽트입니다. 보통 예외라고 합니다.

- 인터럽트의 처리과정을 말해주세요.

- 사용자모드와 관리자모드가 존재하는 이유
    - 컴퓨터 자원들을 보호하기 위해서있습니다.

# 프로세스 동기화

## 공유자원, 경쟁상태, 임계구역

## 피터슨 알고리즘

## 뮤텍스

## 세마포어

## 모니터

# 교착 상태(Deadlock)

## 교착 상태 정의

## 교착 상태 조건

## 교착 상태 해결 방법

## 식사하는 철학자 문제

# 예상질문
1. 프로세스 동기화가 무엇인가요?
 - 여러 프로세스가 공유하는 공통된 자원에 대해서 자원의 일관성을 유지하기 위해 접근을 제어하는 것을 의미합니다.

2. 프로세스 동기화를 문제를 해결하기 위한 조건 3가지가 무엇인가요?
 - 상호배제, 진행, 한계 대기입니다.
 - 상호배제는 임계구역은 한 프로세스씩 접근해야한다는 조건입니다.
 - 진행은 임계구역 내에 실행중인 프로세스가 없을 경우 다음으로 접근할 프로세스가 정해져있어야한다는 조건입니다.
 - 즉, 다음 프로세스를 선정하는데 무기한으로 연기할 수 없다는 조건입니다.
 - 한계 대기는 프로세스들이 임계구역 접근을 요청한 뒤 대기 시간에 한계를 두어 기아 상태를 방지하는 것입니다.

3. 임계구역이 무엇인가요?
 - 프로세스가 공통된 자원에 접근하는 코드들의 집합입니다.
 - 임계구역은 데이터의 일관성 유지가 중요하기 때문에 프로세스 동기화 문제를 해결해주어야합니다.

4. 프로세스 동기화 문제를 해결할 수 있는 알고리즘은 무엇이 있나요?
 - 피터슨 알고리즘과 데커 알고리즘이 있습니다.
 - 피터슨 알고리즘은 flag와 turn변수를 두어서 동시성을 제어하는 알고리즘입니다.
 - flag는 '임계영역에 접근하고 싶은지 여부'를 나타내고,
 - trun변수는 '임계영역에 누가 접근하는지'를 나타냅니다.
 - 데커 알고리즘도 flag와 turn변수를 두어서 동시성을 제어하는 알고리즘입니다.
 - 두 프로세스중 먼저 양보한 쪽이 먼저 임계구역에 들어가게 됨.

5. 상호 배제를 위한 알고리즘에는 무엇이 있나요?
 - 뮤텍스와 세마포어가 있습니다.
 - 뮤텍스는 한 프로세스만 접근이 가능하도록 한 프로세스만 소유할 수 있는 키(변수)를 두어 상호배제를 하는 기법입니다.
 - 세마포어는 임계영역에 접근할 수 있는 프로세스의 갯수를 나타내어 상호배제를 하는 기법입니다.
 - 둘 다 상호배제는 보장이 되지만 데드락이 발생할 수도 있습니다.
 - 데드락은 프로세스 서로가 끝나기만을 기다리게 되어 결국 아무것도 못하는 상태를 의미합니다.

6. 데드락(교착상태)란 무엇인가요?
   - 데드락은 프로세스 서로가 끝나기만을 기다리게 되어 결국 아무것도 못하는 상태를 의미합니다.

7. 데드락이 발생하기 위한 조건 4가지는 무엇인가요?
   - 상호 배제, 점유 대기, 비선점, 순환 대기가 있습니다.
   - 상호 배제는 한 번에 프로세스 하나만 해당 자원을 사용할 수 있다는 의미입니다.
   - 점유 대기는 자원을 최소 하나 이상 가지고 있고, 다른 프로세스가 가진 자원도 필요할 경우 해당 자원을 반납하지 않고 기다리는 것입니다.
   - 비선점은 할당된 자원을 강제로 빼앗을 수는 없다는 의미입니다.
   - 순환 대기는 대기 프로세스는 순환형태로 필요한 자원을 요구하는 형태가 되어야한다입니다.

8. 데드락을 해결할 수 있는 방법은 무엇인가요?
   - 데드락을 예방하거나 회피하여야합니다.
   - 예방하는 방법으로는 해당 조건들을 방지해주어야합니다.
