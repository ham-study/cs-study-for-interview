# TCP/ UDP

TCP/IP 4계층에서 전송계층은 송신자와 수신자간에 통신을 할 때 패킷의 오류를 검사하고 재전송 요구 등의 제어를 담당합니다. 이 때, 데이터를 보내기 위해 TCP와 UDP라는 프로토콜을 사용합니다.



TCP는 송신자와 수신자간에 논리적인 경로를 설정하여 신뢰성을 보장하는 연결형 서비스입니다.

TCP의 특징으로는

- 연결형 서비스로 가상 회선 방식을 제공합니다.
- 3way handshaking 과정을 통해 연결을 설정하고, 4way handshaking을 통해 연결을 해제합니다.
- 높은 신뢰성을 보장합니다.
- 흐름 제어, 혼잡 제어, 오류 제어를 보장합니다.
- UDP보다 속도가 느립니다.

TCP가 가상 회선 방식을 제공한다는 것은 송신자와 수신자를 연결하여 패킷을 전송하기 위한 논리적인 경로를 확보한다는 것입니다. 



UDP는 TCP와 달리 비연결형 프로토콜입니다. 즉, 연결을 위해 할당되는 논리적인 경로가 없어서 각각의 패킷은 다른 경로로 전송되고 처리됩니다.

UDP의 특징으로는

- 비연결형 서비스로 데이터그램 방식을 제공합니다.
- UDP헤더의 Checksum 필드를 통해 최소한의 오류만 검출합니다.
- TCP에 비해 신뢰성이 낮지만 속도는 빠릅니다.
- 일대일, 일대다, 다대다 통신이 가능합니다.

TDP는 비연결형 서비스이기 때문에, 연결을 설정하고 해제하는 과정이 없습니다. 또, 서로 다른 경로로 독립적으로 처리하기 때문에 패킷에 순서를 부여하여 재조립을 하거나 흐름 제어 또는 혼잡 제어 기능을 하지 않아서 TCP보다 속도가 빠르고 네트워크 부하가 적다는 장점이 있지만 신뢰성은 보장하지 못합니다. 그렇기 때문에 신뢰성보다는 연속성이 중요한 스트리밍 같은 서비스에서 사용됩니다.





# 3way handshake, 4way handshake

**3-way handshake**는 신뢰성 있는 통신을 위한 연결을 설정하는 과정입니다.

1. 클라이언트가 SYN 패킷을 서버에 전송
2. 서버는 SYN 패킷을 받고, ACK과 SYN 패킷을 전송
3. 클라이언트는 ACK과 SYN을 받고, 이에 대한 응답으로 ACK을 전송

TCP는 양방향성 연결이기 때문에 클라이언트에서 서버에게 자신의 존재를 알리고 패킷을 보낼 수 있는 것처럼 서버에서도 클라이언트에게 자신의 존재를 알리고 패킷을 보낼 수 있다는 신호를 보내야하기 때문에 2-way가 아닌 3-way를 합니다.



**4-way handshake**는 연결을 해제하는 과정입니다.

1. 클라이언트는 서버에게 연결을 종료하겠다는 FIN 패킷을 전송
2. 서버는 이에 대한 응답으로 ACK 패킷을 전송
3. (처리해야 할 모든 통신을 끝마쳤다면...) 서버는 연결을 종료하겠다는 FIN 패킷을 전송
4. 클라이언트는 이에 대한 응답으로 ACK 패킷을 전송하며, 아직 서버로부터 전송되지 않은 데이터를 받을 수 있기 때문에 TIME_WAIT 상태가 됨
5. 서버는 ACK 패킷을 받고, 소켓 연결을 close 함



# 흐름제어, 혼잡제어, 오류제어

흐름제어는 데이터를 송신하는 곳과 수신하는 곳의 데이터 처리 속도를 조절하여 수신자 버퍼의 오버플로우를 방지하는 것입니다. 예를들어, 수신자는 처리할 수 있는 상태가 아닌데 송신자가 데이터를 계속 보내면 문제가 발생할 수 있습니다. 이 문제를 해결하기 위해 수신자는 window size를 조절하여 수신량을 정할 수 있습니다.



혼잡제어는 네트워크 내의 패킷 수가 넘치지 않게 방지하는 것입니다. 정보의 소통량이 너무 많아지면 패킷을 조금만 전송하여 전체 패킷 수를 조절합니다.



오류제어란, 훼손된 패킷을 감지하고 중복 수신된 패킷은 폐기하며, 순서에 맞지 않는 패킷들은 버퍼에 저장하는 것을 말합니다. 

