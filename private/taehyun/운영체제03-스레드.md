- 스레드개념

  **스레드**(**thread**)는 프로세스 내에서 실제로 작업을 수행하는 주체를 말합니다. 일반적으로 한 프로세스는 하나의 스레드를 가지고 있지만, 프로세스 환경에 따라 둘 이상의 스레드를 동시에 실행할 수 있습니다. 그리고 프로세스 내의 주소 공간이나 자원들을 같은 프로세스 내의 다른 스레드와 공유하면서 실행되는 특징이 있습니다.

  **특징**

  - 스레드는 프로세스 내에서 각각 Stack만 따로 할당받고, Code, Data, Heap 영역은 공유합니다.
  - 한 스레드가 프로세스 자원을 변경하면, 다른 스레드도 그 변경 결과를 즉시 알 수 있습니다.

- 멀티스레드의 구조

  ![img](https://blog.kakaocdn.net/dn/c03dAx/btqBEz6o9Lb/iCB5si14jlPNFXT5701sx1/img.png)

  멀티스레드는 Code, Data, Heap 영역을 공유하고, Stack만 스레드 별로 할당됩니다.

  **Stack만 분리해서 사용하는 이유?**

  스택에 저장되는 데이터들은 지역변수, 매개변수는 공유해선 안되는 값들이고, 콜백할 주소 값의 경우도 공유가 된다면 프로세스의 실행 흐름이 섞이게 때문에 스택은 독립적으로 존재해야 합니다.

- 멀티스레드의 장단점

  멀티 스레드에서는 스레드끼리 프로세스의 메모리를 공유하기 때문에 메모리 공간과 자원 소모가 줄어듭니다. 스레드 간의 통신이 필요한 경우에도 전역 변수 혹은 힙 영역을 이용하여 쉽게 데이터를 주고 받을 수 있으며, 프로세스의 Context Switching과 달리 스레드의 Context Switching은 캐시 메모리를 비울 필요가 없어 더 빠르다는 장점이 있습니다.

  하지만, 공유하는 자원에 동시 접근하는 경우, 동기화 문제가 발생할 수 있습니다. 그리고 동기화 문제를 해결하면서 병목 현상이 발생할 가능성도 높습니다. 또한, 하나의 스레드에 문제가 생기면 전체 프로세스에 영향을 끼치게 됩니다.

- 멀티 프로세스 vs 멀티 스레드

  **멀티 프로세스는** 하나의 응용 프로그램을 여러 개의 프로세스로 구성하여 각 프로세스가 하나의 작업을 처리하는 것입니다. 자식 프로세스 중 하나에 문제가 발생해도 다른 프로세스에는 영향을 끼치지 않는 장점이 있습니다. 하지만, 프로세스는 각각 독립된 메모리를 할당받았기 때문에 프로세스끼리 공유하는 메모리가 없어, Context Switching이 발생하면 캐시 데이터를 모두 리셋하고 다시 정보를 불러와야 하고 프로세스들 사이의  변수를 공유할 수 없다는 단점이 있습니다

  **멀티 스레드는** 하나의 응용 프로그램을 여러 개의 스레드로 구성하고 각 스레드가 하나의 작업을 처리하는 것입니다. 웹 서버가 대표적인 멀티 스레드 프로그램입니다.

  장점으로는 프로세스를 생성하여 자원을 할당하는 시스템 콜이 줄어들어 자원을 효율적으로 관리할 수 있고, 스레드 사이의 작업량이 적어 Context Switching이 빠르고, 스레드끼리는 Stack을 제외한 메모리를 공융하기 때문에 통신 부담이 적습니다.

  단점으로는 멀티 스레드의 경우 자원을 공유하기 때문에 동기화 문제가 발생하고, 하나의 스레드에 문제가 생기면 전체 프로세스에 영향을 끼치게 됩니다.